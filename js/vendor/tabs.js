export class Tabs{constructor(){this._windowWidth=window.innerWidth,this._documentClickHandler=this._documentClickHandler.bind(this),this._init()}_init(){this._initAllTabs(),document.addEventListener("click",this._documentClickHandler)}_resizeObserver(){return new ResizeObserver((t=>{for(let e of t)e.target.classList.contains("is-active")&&this._updateTabHeight()}))}_documentClickHandler(t){const e=t.target;if(!e.closest('[data-tabs="control"]'))return;t.preventDefault();const s=e.closest('[data-tabs="control"]');this.openTab(s)}_initAllTabs(){const t=document.querySelectorAll('[data-tabs="parent"]'),e=document.querySelectorAll('[data-tabs="element"].for-load');t.forEach((t=>{this._initTab(t)})),e.forEach((t=>{t.classList.remove("for-load")}))}_removeAllActiveClasses(t,e){e.forEach((t=>{t.classList.remove("is-active")})),t.forEach(((t,e)=>{t.classList.remove("is-active"),t.setAttribute("data-index",e)}))}_setTabStartState(t,e,s,a,i,r){const n=this._returnActiveIndex(i),l="max"===e?this._returnMaxHeight(s):s[n].offsetHeight;this._removeAllActiveClasses(i,s),t.classList.add("no-transition"),i[n].classList.add("is-active"),s[n].classList.add("is-active"),"unset"!==e&&(a.style.height=`${l}px`),setTimeout((()=>{r&&t.classList.remove("no-transition")}),r)}_returnActiveIndex(t){let e=0,s=!0;return t.forEach(((t,a)=>{t.classList.contains("is-active")&&s&&(e=a,s=!1)})),e}_returnMaxHeight(t){let e=[];return t.forEach((t=>{e.push(t.offsetHeight)})),e.sort(((t,e)=>t-e)),e[e.length-1]}_returnScopeList(t,e){const s=[];return t.forEach((t=>{t.closest('[data-tabs="parent"]')===e&&s.push(t)})),s}_returnScopeChild(t,e){let s;return t.forEach((t=>{t.closest('[data-tabs="parent"]')===e&&(s=t)})),s}_updateTabHeight(){document.querySelectorAll('[data-tabs="element"].is-active').forEach((t=>{let e=!1;t.closest('[data-tabs="parent"]').closest('[data-tabs="element"]')&&(e=!0),this._setTabElementHeight(t,e)}))}_setTabElementHeight(t,e){const s=t.closest('[data-tabs="parent"]'),a=s.dataset.height,i=this._returnScopeChild(s.querySelectorAll('[data-tabs="content"]'),s),r=this._returnScopeList(s.querySelectorAll('[data-tabs="element"]'),s);e||s.classList.add("no-transition"),i.style.height="max"===a?`${this._returnMaxHeight(r)}px`:"unset"===a?null:`${this._returnScopeChild(s.querySelectorAll('[data-tabs="element"].is-active'),s).offsetHeight}px`,setTimeout((()=>s.classList.remove("no-transition")))}_initTab(t){const e=t.dataset.height,s=t.dataset.delay?t.dataset.delay:0,a=t.querySelector('[data-tabs="content"]'),i=this._returnScopeList(t.querySelectorAll('[data-tabs="control"]'),t),r=this._returnScopeList(t.querySelectorAll('[data-tabs="element"]'),t);this._setTabStartState(t,e,r,a,i,s),"unset"!==e&&r.forEach((t=>{this._resizeObserver().observe(t)})),setTimeout((()=>{t.classList.remove("no-transition-global")}))}reInit(){this._initAllTabs()}openTab(t){const e=t.dataset.index,s=t.closest('[data-tabs="parent"]');if(t.classList.contains("is-active")||s.classList.contains("no-action"))return;const a=s.dataset.delay?s.dataset.delay:0,i=s.dataset.height,r=s.querySelector('[data-tabs="content"]'),n=this._returnScopeList(s.querySelectorAll('[data-tabs="element"]'),s),l=this._returnScopeChild(s.querySelectorAll('[data-tabs="control"].is-active'),s),o=this._returnScopeChild(s.querySelectorAll('[data-tabs="element"].is-active'),s),c=r.offsetHeight,d=n[e].offsetHeight;s.classList.add("no-action"),document.activeElement.blur(),l&&l.classList.remove("is-active"),o&&o.classList.remove("is-active"),c>d?setTimeout((()=>{"max"!==i&&"unset"!==i&&(r.style.height=d+"px"),t.classList.add("is-active"),n[e].classList.add("is-active"),s.classList.remove("no-action")}),a):("max"!==i&&"unset"!==i&&(r.style.height=d+"px"),setTimeout((()=>{t.classList.add("is-active"),n[e].classList.add("is-active"),s.classList.remove("no-action")}),a))}}